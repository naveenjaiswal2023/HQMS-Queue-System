@using HQMS.Web.Models
@model IEnumerable<PatientModel>

@{
    ViewData["Title"] = "Patients";
}

<div class="container-lg mt-4">
    <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center mb-3 gap-2">
        <h2 class="text-primary mb-0">
            <i class="fas fa-user-injured me-2"></i>Patients
        </h2>

        <a asp-action="Create" class="btn btn-success">
            <i class="fas fa-plus me-1"></i> Add Patient
        </a>
    </div>

    <div class="card shadow-sm">
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-striped table-hover align-middle datatables" id="patientsTable">
                    <thead class="table-success text-white">
                        <tr>
                            <th class="text-nowrap">#</th>
                            <th>Name</th>
                            <th class="d-none d-lg-table-cell">Age</th>
                            <th class="d-none d-lg-table-cell">Gender</th>
                            <th class="d-none d-xxl-table-cell">Hospital</th>
                            <th class="d-none d-xxl-table-cell">Doctor</th>
                            <th class="d-none d-xl-table-cell">Department</th>
                            <th class="d-none d-xl-table-cell">Phone</th>
                            <th class="d-none d-xxl-table-cell">Email</th>
                            <th class="d-none d-xxl-table-cell">Blood Group</th>
                            <th class="text-nowrap">Registered</th>
                            <th class="text-center">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (Model?.Any() == true)
                        {
                            var idx = 1;
                            foreach (var p in Model)
                            {
                                <tr data-patient-id="@p.PatientId">
                                    <td></td>
                                    <td>@p.Name</td>
                                    <td class="d-none d-lg-table-cell">@p.Age</td>
                                    <td class="d-none d-lg-table-cell">@p.Gender</td>
                                    <td class="d-none d-lg-table-cell">@p.HospitalName</td>
                                    <td class="d-none d-lg-table-cell">@p.DoctorName</td>
                                    <td class="d-none d-xl-table-cell">@p.DepartmentName</td>
                                    <td class="d-none d-xl-table-cell">@p.PhoneNumber</td>
                                    <td class="d-none d-xxl-table-cell">@p.Email</td>
                                    <td class="d-none d-xxl-table-cell">@p.BloodGroup</td>
                                    <td>
                                        @(p.RegisteredAt.Year > 1
                                                                        ? p.RegisteredAt.ToString("dd‑MMM‑yyyy HH:mm")
                                                                        : "N/A")
                            </td>
                            <td class="text-center">
                                <a asp-action="Edit"
                                   asp-route-id="@p.PatientId"
                                   class="btn btn-sm btn-outline-primary me-1">
                                    <i class="fas fa-edit"></i>
                                </a>
                                <a asp-action="Delete"
                                   asp-route-id="@p.PatientId"
                                   class="btn btn-sm btn-outline-danger">
                                    <i class="fas fa-trash-alt"></i>
                                </a>
                            </td>
                        </tr>
                                                }
                        }
                        else
                        {
                            <tr>
                                <td colspan="10" class="text-center text-muted py-4">
                                    No patients found.
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
